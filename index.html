<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login - GIBRAN STORE</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #ff6600, #ff9933); min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; font-family: sans-serif; }
        .login-card { background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); width: 100%; max-width: 400px; }
        .form-label { font-size: 13px; font-weight: bold; color: #555; margin-bottom: 5px; }
        .form-control { border-radius: 12px; margin-bottom: 15px; border: 2px solid #eee; padding: 12px; }
        .btn-masuk { background: #ff6600; color: white; border: none; padding: 14px; border-radius: 12px; width: 100%; font-weight: bold; transition: 0.3s; margin-top: 10px; }
        .btn-masuk:disabled { background: #ccc; }
    </style>
</head>
<body>

<div class="login-card">
    <div class="text-center mb-4">
        <h2 class="fw-bold mb-0">ðŸ›’ GIBRAN STORE</h2>
        <p class="text-muted small">Lengkapi data untuk pesanan</p>
    </div>

    <form id="formLogin">
        <label class="form-label">Nama Lengkap</label>
        <input type="text" id="nama" class="form-control" placeholder="Nama Anda" required>

        <label class="form-label">Nomor HP (WhatsApp)</label>
        <input type="number" id="hp" class="form-control" placeholder="08xxx" required>

        <label class="form-label">Alamat Rumah / No. Rumah</label>
        <textarea id="alamat" class="form-control" rows="2" placeholder="Alamat lengkap pengiriman..." required></textarea>

        <button type="submit" id="btnSubmit" class="btn-masuk">SIMPAN & MULAI BELANJA</button>
    </form>
    
    <p id="pesanError" class="text-danger small mt-3 text-center" style="display:none;">Gagal mengirim data, coba lagi!</p>
</div>

<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbwrfPJASMS4L6EQjqlRrf4qWbYJS39WdH97ZZrY-gaGoRem5rZU54ZhedWwKzZr8lBJbA/exec';
    const form = document.getElementById('formLogin');
    const btnSubmit = document.getElementById('btnSubmit');

    // CEK: Jika user sudah login, JANGAN lari ke dashboard dulu supaya kita bisa tes
    // Tapi kalau mau otomatis, aktifkan kode di bawah ini nanti.
    // if(localStorage.getItem('namaUser')) { window.location.href = 'dashboard.html'; }

    form.addEventListener('submit', e => {
        e.preventDefault();
        btnSubmit.disabled = true;
        btnSubmit.innerText = "Mendaftarkan...";

        const dataKirim = {
            sheet: "User", 
            tanggal: new Date().toLocaleString('id-ID'),
            nama: document.getElementById('nama').value,
            hp: document.getElementById('hp').value,
            alamat: document.getElementById('alamat').value
        };

        // Kirim data ke Google Sheets
        fetch(scriptURL, { 
            method: 'POST', 
            mode: 'no-cors',
            body: JSON.stringify(dataKirim)
        })
        .then(() => {
            // Berhasil! Simpan data ke browser
            localStorage.setItem('namaUser', dataKirim.nama);
            localStorage.setItem('hpUser', dataKirim.hp);
            localStorage.setItem('alamatUser', dataKirim.alamat);
            
            // Pindah ke Dashboard
            window.location.href = 'dashboard.html';
        })
        .catch(error => {
            document.getElementById('pesanError').style.display = 'block';
            btnSubmit.disabled = false;
            btnSubmit.innerText = "SIMPAN & MULAI BELANJA";
        });
    });
</script>

</body>
</html>
