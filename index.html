<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Login Pelanggan - GIBRAN STORE</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: linear-gradient(135deg, #ff6600, #ff9933); min-height: 100vh; display: flex; align-items: center; justify-content: center; padding: 20px; font-family: sans-serif; }
        .login-card { background: white; padding: 30px; border-radius: 25px; box-shadow: 0 10px 30px rgba(0,0,0,0.2); width: 100%; max-width: 400px; }
        .form-label { font-size: 13px; font-weight: bold; color: #555; margin-bottom: 5px; }
        .form-control { border-radius: 10px; margin-bottom: 15px; border: 2px solid #eee; }
        .btn-masuk { background: #ff6600; color: white; border: none; padding: 12px; border-radius: 10px; width: 100%; font-weight: bold; transition: 0.3s; }
        .btn-masuk:disabled { background: #ccc; }
    </style>
</head>
<body>

<div class="login-card">
    <div class="text-center mb-4">
        <h2 class="fw-bold mb-0">ðŸ›’ GIBRAN STORE</h2>
        <p class="text-muted small">Lengkapi data untuk mulai belanja</p>
    </div>

    <form id="formLogin">
        <label class="form-label">Nama Lengkap</label>
        <input type="text" name="nama" id="nama" class="form-control" placeholder="Masukkan nama..." required>

        <label class="form-label">Nomor HP (WhatsApp)</label>
        <input type="number" name="hp" id="hp" class="form-control" placeholder="08123xxx" required>

        <label class="form-label">Alamat Rumah / No. Rumah</label>
        <textarea name="alamat" id="alamat" class="form-control" rows="2" placeholder="Contoh: Jl. Anggrek No. 15" required></textarea>

        <button type="submit" id="btnSubmit" class="btn-masuk">SIMPAN & MULAI BELANJA</button>
    </form>
</div>

<script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbz5AFV3T5U7X3IOVAmxzVz6bw0f5BqKb7ngzEVlezllXHLHCIvFJthyQ7DiCpdeFp7u3w/exec';
    const form = document.getElementById('formLogin');
    const btnSubmit = document.getElementById('btnSubmit');

    form.addEventListener('submit', e => {
        e.preventDefault();
        btnSubmit.disabled = true;
        btnSubmit.innerText = "Mendaftarkan...";

        const dataKirim = {
            sheet: "User", // Memberi tahu Apps Script untuk masuk ke sheet 'User'
            tanggal: new Date().toLocaleString('id-ID'),
            nama: document.getElementById('nama').value,
            hp: document.getElementById('hp').value,
            alamat: document.getElementById('alamat').value
        };

        fetch(scriptURL, { 
            method: 'POST', 
            mode: 'no-cors',
            body: JSON.stringify(dataKirim)
        })
        .then(() => {
            // Simpan ke memori HP agar dashboard bisa panggil namanya
            localStorage.setItem('namaUser', dataKirim.nama);
            localStorage.setItem('hpUser', dataKirim.hp);
            localStorage.setItem('alamatUser', dataKirim.alamat);
            
            window.location.href = 'dashboard.html';
        })
        .catch(error => {
            alert('Waduh error Bran! Coba lagi.');
            btnSubmit.disabled = false;
            btnSubmit.innerText = "SIMPAN & MULAI BELANJA";
        });
    });

    // Jika sudah pernah login, langsung ke dashboard
    if(localStorage.getItem('namaUser')) {
        window.location.href = 'dashboard.html';
    }
</script>

</body>
</html>
